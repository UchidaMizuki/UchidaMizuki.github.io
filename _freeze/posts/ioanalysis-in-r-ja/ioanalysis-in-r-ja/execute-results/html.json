{
  "hash": "76595aaccbec3e173ed1acecdcffb2cd",
  "result": {
    "markdown": "---\ntitle: \"🗾Rで産業連関分析\"\nlang: ja\ndate: \"2022-05-31\"\ncategories: [ioanalysis, R, Japanese]\n---\n\n\n産業連関分析は，経済波及効果の算出に広く用いられている分析手法です．\n日本では，国や都道府県によって，約5年に1度，産業連関表と呼ばれる統計データが\n作成・公開されており，産業連関分析における基礎データとなっています．\n\nこれまで，産業連関分析では，Excel・VBAが用いられることが多かったようです．\n\n一方で，近年は，Python・R・Juliaなどのプログラミング言語の普及が進んでいます．\nこれらのプログラミング言語は以下のような特長を持っています．\n\n- 無料で利用することができる\n- 作業の再現性が高まりミスが修正しやすい・他者がミスに気づきやすい\n- 高度な分析手法が簡単に利用できる\n\nそのため今後は，産業連関分析においても，これらのプログラミング言語の利用が\n進むのではないかと思われます．\n\nここでは，Rを用いて産業連関分析を行います．\nRでは近年，tidyverseなどモダンなデータ分析を行うためのパッケージが\n多く提供されており，プログラミング初心者でも習得しやすい言語であると思います．\n\n産業連関表として，e-Statのデータベースで公開されている日本（国）の\n2013年・13部門産業連関表を用います．\nここで使用するデータは，\n[こちら](https://github.com/UchidaMizuki/blog-ioanalysis-in-r)\nからダウンロードできます．\n\n\n\n## 分析の流れ\n\n一般的な産業連関分析の流れは以下の通りです．\n\n1. 産業連関表の整形\n1. 投入係数行列の算出\n1. レオンチェフ逆行列の算出\n1. 経済波及効果の算出\n\n以上の流れに沿って，Rによる産業連関分析の計算例を示します．\n\n\n\n## Rによる産業連関分析\n### 産業連関表の整形\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\niotable_wider <- read_csv(\"iotable_3sector_2011_wider.csv\",\n                          col_types = cols(.default = \"c\"))\n\nknitr::kable(iotable_wider)\n```\n\n::: {.cell-output-display}\n|input                    |industry/01_primary |industry/02_secondary |industry/03_tertiary |finaldemand/04_finaldemand |export/05_export |import/06_import |\n|:------------------------|:-------------------|:---------------------|:--------------------|:--------------------------|:----------------|:----------------|\n|industry/01_primary      |1456611000000       |7850628000000         |1373767000000        |3869875000000              |47890000000      |-2562809000000   |\n|industry/02_secondary    |2715710000000       |161897553000000       |62841827000000       |132924323000000            |54473273000000   |-71673715000000  |\n|industry/03_tertiary     |2025270000000       |66811645000000        |155796589000000      |352324555000000            |16423417000000   |-8921553000000   |\n|valueadded/04_valueadded |5838371000000       |106619145000000       |364447740000000      |NA                         |NA               |NA               |\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\niotable <- iotable_wider |>\n  separate(input, c(\"input_type\", \"input_name\"),\n           sep = \"/\") |>\n  pivot_longer(!c(input_type, input_name),\n               names_to = c(\"output_type\", \"output_name\"),\n               names_sep = \"/\",\n               values_to = \"value\",\n               values_transform = list(value = parse_number)) |>\n  drop_na(value)\n\nknitr::kable(iotable)\n```\n\n::: {.cell-output-display}\n|input_type |input_name    |output_type |output_name    |         value|\n|:----------|:-------------|:-----------|:--------------|-------------:|\n|industry   |01_primary    |industry    |01_primary     |  1.456611e+12|\n|industry   |01_primary    |industry    |02_secondary   |  7.850628e+12|\n|industry   |01_primary    |industry    |03_tertiary    |  1.373767e+12|\n|industry   |01_primary    |finaldemand |04_finaldemand |  3.869875e+12|\n|industry   |01_primary    |export      |05_export      |  4.789000e+10|\n|industry   |01_primary    |import      |06_import      | -2.562809e+12|\n|industry   |02_secondary  |industry    |01_primary     |  2.715710e+12|\n|industry   |02_secondary  |industry    |02_secondary   |  1.618976e+14|\n|industry   |02_secondary  |industry    |03_tertiary    |  6.284183e+13|\n|industry   |02_secondary  |finaldemand |04_finaldemand |  1.329243e+14|\n|industry   |02_secondary  |export      |05_export      |  5.447327e+13|\n|industry   |02_secondary  |import      |06_import      | -7.167372e+13|\n|industry   |03_tertiary   |industry    |01_primary     |  2.025270e+12|\n|industry   |03_tertiary   |industry    |02_secondary   |  6.681165e+13|\n|industry   |03_tertiary   |industry    |03_tertiary    |  1.557966e+14|\n|industry   |03_tertiary   |finaldemand |04_finaldemand |  3.523246e+14|\n|industry   |03_tertiary   |export      |05_export      |  1.642342e+13|\n|industry   |03_tertiary   |import      |06_import      | -8.921553e+12|\n|valueadded |04_valueadded |industry    |01_primary     |  5.838371e+12|\n|valueadded |04_valueadded |industry    |02_secondary   |  1.066191e+14|\n|valueadded |04_valueadded |industry    |03_tertiary    |  3.644477e+14|\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dibble)\n\niotable <- iotable |>\n  dibble_by(input = c(input_type, input_name),\n            output = c(output_type, output_name),\n            .names_sep = \"_\")\n\niotable\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A dibble:   24 x 1\n# Dimensions: input [4], output [6]\n# Measures:   value\n   input$type $name        output$type $name             value\n   <chr>      <chr>        <chr>       <chr>             <dbl>\n 1 industry   01_primary   industry    01_primary      1.46e12\n 2 industry   01_primary   industry    02_secondary    7.85e12\n 3 industry   01_primary   industry    03_tertiary     1.37e12\n 4 industry   01_primary   finaldemand 04_finaldemand  3.87e12\n 5 industry   01_primary   export      05_export       4.79e10\n 6 industry   01_primary   import      06_import      -2.56e12\n 7 industry   02_secondary industry    01_primary      2.72e12\n 8 industry   02_secondary industry    02_secondary    1.62e14\n 9 industry   02_secondary industry    03_tertiary     6.28e13\n10 industry   02_secondary finaldemand 04_finaldemand  1.33e14\n# … with 14 more rows\n```\n:::\n:::\n\n\n### 投入係数行列の算出\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntotal_input <- iotable |>\n  filter(output$type == \"industry\") |>\n  apply(\"output\", sum)\n\ninterindustry <- iotable |>\n  filter(input$type == \"industry\",\n         output$type == \"industry\")\n\ninputcoeff <- broadcast(interindustry / total_input,\n                        c(\"input\", \"output\"))\n\ninputcoeff\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A dibble:   9\n# Dimensions: input [3], output [3]\n  input$type $name        output$type $name              .\n  <chr>      <chr>        <chr>       <chr>          <dbl>\n1 industry   01_primary   industry    01_primary   0.121  \n2 industry   01_primary   industry    02_secondary 0.0229 \n3 industry   01_primary   industry    03_tertiary  0.00235\n4 industry   02_secondary industry    01_primary   0.226  \n5 industry   02_secondary industry    02_secondary 0.472  \n6 industry   02_secondary industry    03_tertiary  0.108  \n7 industry   03_tertiary  industry    01_primary   0.168  \n8 industry   03_tertiary  industry    02_secondary 0.195  \n9 industry   03_tertiary  industry    03_tertiary  0.267  \n```\n:::\n:::\n\n\n### レオンチェフ逆行列の算出\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlocaloutput <- iotable |>\n  filter(input$type == \"industry\",\n         !output$type %in% c(\"export\", \"import\")) |>\n  apply(\"input\", sum)\n\nimport <- iotable |>\n  filter(input$type == \"industry\",\n         output$type == \"import\") |>\n  apply(\"input\", sum)\nimport <- -import\n\nimportcoeff <- import / localoutput\n\nI <- eye(inputcoeff)\nM <- importcoeff\nA <- inputcoeff\n\nleontiefinv <- broadcast(I - (1 - M) * A,\n                         c(\"input\", \"output\")) |>\n  solve()\n\nleontiefinv\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A dibble:   9\n# Dimensions: output [3], input [3]\n  output$type $name        input$type $name              .\n  <chr>       <chr>        <chr>      <chr>          <dbl>\n1 industry    01_primary   industry   01_primary   1.12   \n2 industry    01_primary   industry   02_secondary 0.0361 \n3 industry    01_primary   industry   03_tertiary  0.00716\n4 industry    02_secondary industry   01_primary   0.374  \n5 industry    02_secondary industry   02_secondary 1.68   \n6 industry    02_secondary industry   03_tertiary  0.197  \n7 industry    03_tertiary  industry   01_primary   0.348  \n8 industry    03_tertiary  industry   02_secondary 0.445  \n9 industry    03_tertiary  industry   03_tertiary  1.41   \n```\n:::\n:::\n\n\n### 経済波及効果の算出\n\nTODO\n\n## まとめ\n\nTODO",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}